<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link rel="canonical" href="https://www.patternsgameprog.com/discover-python-and-patterns-13-sprites" />
<meta name="description" content="Draw sprites with Python and Pygame.">
<meta name="author" content="Philippe-Henri Gosselin">
<meta name='robots' content='index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1' />
<link rel="icon" href="assets/img/favicon.ico">
<title>Design Patterns and Video Games</title>
<link href="https://www.patternsgameprog.com/assets/css/bootstrap.min.css" rel="stylesheet">
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css?family=Righteous" rel="stylesheet">
<link href="https://www.patternsgameprog.com/assets/css/mediumish.css" rel="stylesheet">
<link href="https://www.patternsgameprog.com/assets/css/darcula.css" rel="stylesheet">

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-150349446-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-150349446-1');
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-NB1HVSF9XH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-NB1HVSF9XH');
</script>

<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

</head>
<body>

<!-- Begin Nav
================================================== -->
<nav class="navbar navbar-toggleable-md navbar-light bg-white fixed-top mediumnavigation">
<button class="navbar-toggler navbar-toggler-right" type="button" data-toggle="collapse" data-target="#navbarsExampleDefault" aria-controls="navbarsExampleDefault" aria-expanded="false" aria-label="Toggle navigation">
<span class="navbar-toggler-icon"></span>
</button>
<div class="container">
	<a class="navbar-brand" href="https://www.patternsgameprog.com">
	Design Patterns and Video Games
	</a>
	
	<div class="collapse navbar-collapse" id="navbarsExampleDefault">
		<ul class="navbar-nav ml-auto">
						<li class="nav-item">
			<a class="nav-link" href="https://www.patternsgameprog.com/series">Series</a>
			</li>
						<li class="nav-item">
			<a class="nav-link" href="https://www.patternsgameprog.com/more">More</a>
			</li>
						<li class="nav-item">
			<a class="nav-link" href="https://www.patternsgameprog.com/about">About</a>
			</li>
									
		</ul>
	</div>
</div>
</nav>
<!-- End Nav
================================================== -->



<div class="container">
	<div class="mainheading">
		<img class="featured-image img-fluid" src="https://www.patternsgameprog.com/assets/img/header.png" alt="Design Patterns and Video Games">
	</div>
<!-- End Site Title
================================================== -->

	<div class="section-title">
		<h2><span>Discover Python and Patterns (13): Sprites</span></h2>
	</div>

<p>In this post, I propose to replace the rectangle in the previous program with a tank sprite, using a tileset.</p>
<p><em>This post is part of the <a href="https://www.patternsgameprog.com/series/discover-python-and-patterns/">Discover Python and Patterns series</a></em>  </p>
<h2>Tileset</h2>
<p>I wish to create a "tank battle" game, so I looked for free game assets containing tank tilesets. You can found many on <a href="https://itch.io/">itch.io</a>. I selected this one: <a href="https://zintoki.itch.io/ground-shaker">zintoki.itch.io/ground-shaker</a>, created by <a href="https://itch.io/profile/zintoki">zintoki</a>. I selected all the sprites I need and gathered them into a single image:</p>
<figure><img alt="Tank tileset" class="centered-image img-fluid" src="https://www.patternsgameprog.com/media/pages/discover-python-and-patterns-13-sprites/867e4e6172-1621709003/13_tank_tileset-1024x1024.png" width="448"></figure>
<p>To load an image with Pygame, we can do as before with the <code>pygame.image.load()</code>function:</p>
<pre class="hljs"><code>unitsTexture = pygame.image.load(<span class="hljs-string">"units.png"</span>)</code></pre>
<h2>Draw a sprite from a tileset</h2>
<p>To draw a sprite from a tileset, we need to select the area in the tileset with the sprite, and copy it at any location on the screen:</p>
<figure><img alt="Draw a sprite using a tileset" class="centered-image img-fluid" src="https://www.patternsgameprog.com/media/pages/discover-python-and-patterns-13-sprites/428325fbee-1621709003/13_draw_sprite.png" width="596"></figure>
<p>Any instance of the <code>pygame.Surface</code> class can do this copy using the <code>blit()</code>method. We can obtain such a surface when we create a window:</p>
<pre class="hljs"><code>window = pygame.display.set_mode((<span class="hljs-number">256</span>,<span class="hljs-number">256</span>))</code></pre>
<p>This method has three arguments: the tileset image, the location in the surface (the screen in the case of the window), and the rectangle in the tileset.</p>
<p>We can represent locations using tuples <code>(x,y)</code>, but I will use instances of the <code>pygame.math.Vector2</code> class because it has many nice features:</p>
<pre class="hljs"><code>location = pygame.math.Vector2(x,y)</code></pre>
<p>Pygame represents rectangles with instances of the <code>pygame.Rect</code> class:</p>
<pre class="hljs"><code>rectangle = pygame.Rect(x,y,width,height)</code></pre>
<p><code>x</code> and <code>y</code> are the coordinates of the top left corner and <code>width</code> and <code>height</code> the width and height of the rectangle.</p>
<p>Then, the <code>blit()</code> method can be used, for instance:</p>
<pre class="hljs"><code>window.blit(unitsTexture,location,rectangle)</code></pre>
<p><code>location</code> is the location of the sprite in the surface (screen), and <code>rectangle</code> is the area in the <code>unitsTexture</code> tileset.</p>
<h2>Draw a tank sprite</h2>
<p>For the case of our tank tileset, all sprites are <code>width = 64</code> per <code>height = 64</code> pixels. Furthermore, to select the tank in the first line and second column, the top left coordinates are: <code>x = 0</code> and <code>y = 64</code>. The rectangle is then:</p>
<pre class="hljs"><code>textureRect = pygame.Rect(<span class="hljs-number">64</span>, <span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">64</span>)</code></pre>
<p>If we want to display the tank near the center of a window of 256 per 256 pixels, we need a rectangle at coordinates <code>x = 96</code> and <code>y = 96</code> (and with the same size):</p>
<pre class="hljs"><code>location = pygame.math.Vector2(<span class="hljs-number">96</span>, <span class="hljs-number">96</span>)</code></pre>
<p>The following program contains all I presented (you can copy/paste it in Spyder, and run it):</p>
<pre class="hljs"><code><span class="hljs-keyword">import</span> pygame

unitsTexture = pygame.image.load(<span class="hljs-string">"units.png"</span>)
window = pygame.display.set_mode((<span class="hljs-number">256</span>,<span class="hljs-number">256</span>))
location = pygame.math.Vector2(<span class="hljs-number">96</span>, <span class="hljs-number">96</span>)
rectangle = pygame.Rect(<span class="hljs-number">64</span>, <span class="hljs-number">0</span>, <span class="hljs-number">64</span>, <span class="hljs-number">64</span>)
window.blit(unitsTexture,location,rectangle)

<span class="hljs-keyword">while</span> <span class="hljs-literal">True</span>:
    event = pygame.event.poll()
    <span class="hljs-keyword">if</span> event.type == pygame.QUIT:
        <span class="hljs-keyword">break</span>
    pygame.display.update()    

pygame.quit()</code></pre>
<h2>Control the tank</h2>
<p>I propose to replace the rectangle in the <a href="https://www.patternsgameprog.com/discover-python-and-patterns-12-command-pattern/">previous program</a> to display and move a tank using the keyboard arrows.</p>
<p>Here is the structure of this program, updated from the <a href="https://www.patternsgameprog.com/discover-python-and-patterns-12-command-pattern/">previous one</a>:</p>
<figure><img alt="Discover Python &amp; Patterns (13): Sprites" class="centered-image img-fluid" src="https://www.patternsgameprog.com/media/pages/discover-python-and-patterns-13-sprites/265ccf4455-1621709004/13_class_diagram-1024x435.png" width="512"></figure>
<p>Class <code>UserInterface</code>:</p>
<ul>
<li>New attribute <code>cellSize</code>: defines the size of sprites. It makes a more readable code, and ease the update to sprites of a different size.</li>
<li>New attribute <code>moveTankCommand</code>: it replaces the previous <code>moveCommandX</code> and <code>moveCommandY</code> attributes, and contains the next move command for the tank.</li>
<li>New attribute <code>unitsTexture</code>: contains the tileset image</li>
</ul>
<p>Class <code>GameState</code>:</p>
<ul>
<li>New attribute <code>worldSize</code>: defines the size of the world.</li>
<li>New attribute <code>tankPos</code>: defines the location of the tank, and replaces the previous <code>x</code> and <code>y</code> attributes.</li>
</ul>
<h3>Class <code>UserInterface</code> constructor</h3>
<p>New lines are added to create new attributes:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self)</span>:</span>
    pygame.init()

    self.gameState = GameState()

    self.cellSize = Vector2(<span class="hljs-number">64</span>,<span class="hljs-number">64</span>)
    self.unitsTexture = pygame.image.load(<span class="hljs-string">"units.png"</span>)

    windowSize = self.gameState.worldSize.elementwise() * self.cellSize
    self.window = pygame.display.set_mode((int(windowSize.x),int(windowSize.y)))
    pygame.display.set_caption(<span class="hljs-string">"Discover Python &amp; Patterns - https://www.patternsgameprog.com"</span>)
    pygame.display.set_icon(pygame.image.load(<span class="hljs-string">"icon.png"</span>))
    self.moveTankCommand = Vector2(<span class="hljs-number">0</span>,<span class="hljs-number">0</span>)

    self.clock = pygame.time.Clock()
    self.running = <span class="hljs-literal">True</span></code></pre>
<p>As for most 2D coordinates, I use the <code>pygame.math.Vector2</code> class. To ease the reading, I added <code>from pygame.math import Vector2</code> at the beginning of the program, so we only have to type <code>Vector2</code> rather than <code>pygame.math.Vector2</code>.</p>
<p>I compute the size of the window according to the size of the game world (line 12). This expression is equivalent to:</p>
<pre class="hljs"><code>windowSize = Vector2()
windowSize.x = self.gameState.worldSize.x * self.cellSize.x
windowSize.y = self.gameState.worldSize.y * self.cellSize.y</code></pre>
<p>In other words, the size in pixels of the window is the size of the game world multiplied by the size of a cell/sprite. If the world size is (16,10) and the cell size (64,64), then the window size is <code>(16 * 64,10 * 64) = (1024,640)</code>.</p>
<p>Note that <code>Vector2</code> contains float values (numbers with a decimal part). So, to use it with <code>pygame.display.set_mode()</code>, we must convert it to a tuple of integers: <code>(int(windowSize.x),int(windowSize.y))</code>. If this expression is not clear, we could write:</p>
<pre class="hljs"><code>windowSizeX = int(windowSize.x)
windowSizeY = int(windowSize.y)
windowSizeInteger = (windowSizeX,windowSizeY)
self.window = pygame.display.set_mode(windowSizeInteger)</code></pre>
<h3>Class <code>UserInterface</code> method <code>render()</code></h3>
<p>This method draws a tank (only the base, no turret yet):</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">render</span><span class="hljs-params">(self)</span>:</span>
    self.window.fill((<span class="hljs-number">0</span>,<span class="hljs-number">0</span>,<span class="hljs-number">0</span>))

    spritePoint = self.gameState.tankPos.elementwise()*self.cellSize
    texturePoint = Vector2(<span class="hljs-number">1</span>,<span class="hljs-number">0</span>).elementwise()*self.cellSize
    textureRect = Rect(int(texturePoint.x), int(texturePoint.y), int(self.cellSize.x),int(self.cellSize.y))
    self.window.blit(self.unitsTexture,spritePoint,textureRect)

    pygame.display.update()   </code></pre>
<p>The expression at line 4 is similar to the one I used to compute the size of the window: it multiplies the tank location by the size of a cell/sprite. This expression is equivalent to:</p>
<pre class="hljs"><code>spritePoint = Vector2()
spritePoint.x = self.gameState.tankPos.x * self.cellSize.x
spritePoint.y = self.gameState.tankPos.y * self.cellSize.y</code></pre>
<p>Line 5 computes the top-left corner of the rectangle that contains the tank sprite.</p>
<p>Line 6 creates a rectangle that contains the tank sprite. We have to convert float values into integers.</p>
<p>Line 7 draws the tank in the window surface.</p>
<h3>Class <code>GameState</code> method <code>update()</code></h3>
<p>The <code>update()</code> method works as before, except that the player can't move the tank outside the world:</p>
<pre class="hljs"><code><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self,moveTankCommand)</span>:</span>
    self.tankPos += moveTankCommand

    <span class="hljs-keyword">if</span> self.tankPos.x &lt; <span class="hljs-number">0</span>:
        self.tankPos.x = <span class="hljs-number">0</span>
    <span class="hljs-keyword">elif</span> self.tankPos.x &gt;= self.worldSize.x:
        self.tankPos.x = self.worldSize.x - <span class="hljs-number">1</span>

    <span class="hljs-keyword">if</span> self.tankPos.y &lt; <span class="hljs-number">0</span>:
        self.tankPos.y = <span class="hljs-number">0</span>
    <span class="hljs-keyword">elif</span> self.tankPos.y &gt;= self.worldSize.y:
        self.tankPos.y = self.worldSize.y - <span class="hljs-number">1</span></code></pre>
<h2>Final code</h2>
<p><a href="https://www.patternsgameprog.com/discover-python-and-patterns-13-sprites/discover_python_patterns_13_sprites.zip">Download code &amp; assets</a></p>
<p>In the <a href="https://www.patternsgameprog.com/discover-python-and-patterns-14-collisions/">next post</a>, we'll add towers and start to handle collisions.</p>
	<!-- Begin Footer
	================================================== -->
	<div class="footer">
		<p class="pull-left">
			 Copyright &copy; 2020-2023 https://www.patternsgameprog.com
		</p>
		<p class="pull-right">
			<a href="https://twitter.com/umlgameprog?ref_src=twsrc%5Etfw" class="twitter-follow-button" data-show-count="false">Follow @umlgameprog</a></script>
		</p>
		<div class="clearfix">
		</div>
	</div>
	<!-- End Footer
	================================================== -->

</div>
<!-- /.container -->

<!-- Bootstrap core JavaScript
    ================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://www.patternsgameprog.com/assets/js/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
<script src="https://www.patternsgameprog.com/assets/js/bootstrap.min.js"></script>
<script src="https://www.patternsgameprog.com/assets/js/ie10-viewport-bug-workaround.js"></script>
<script src="https://www.patternsgameprog.com/assets/js/mediumish.js"></script>
</body>
</html>