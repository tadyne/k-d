<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<!-- Created by htmlize-1.16 in css mode. -->
<html>
  <head>
    <title>jogo.py</title>
    <style type="text/css">
    <!--
      body {
        color: #000000;
        background-color: #ffffff;
      }
      .comment {
        /* font-lock-comment-face */
        color: #b22222;
      }
      .function-name {
        /* font-lock-function-name-face */
        color: #0000ff;
      }
      .keyword {
        /* font-lock-keyword-face */
        color: #a020f0;
      }
      .py-builtins {
        /* py-builtins-face */
        color: #a731f1;
      }
      .py-pseudo-keyword {
        /* py-pseudo-keyword-face */
        color: #a731f1;
      }
      .string {
        /* font-lock-string-face */
        color: #bc8f8f;
      }
      .type {
        /* font-lock-type-face */
        color: #228b22;
      }
      a {
        color: inherit;
        background-color: inherit;
        font: inherit;
        text-decoration: inherit;
      }
      a:hover {
        text-decoration: underline;
      }
    -->
    </style>
  </head>
  <body>
    <pre>
<span class="comment">#!/usr/bin/env python2.3
# -*- coding: utf-8 -*-
</span>
<span class="comment">###############################################################################
#
# Mudan&#231;as em rela&#231;&#227;o &#224; vers&#227;o anterior:
#    - otimiza&#231;&#245;es: usar colorkey ao inv&#233;s de transpar&#234;ncia por pixel (alpha)
#
###############################################################################
</span>
<span class="keyword">import</span> os, sys, copy
<span class="keyword">import</span> getopt

<span class="comment"># E importaremos o pygame tambem para esse exemplo
</span><span class="keyword">import</span> pygame
<span class="keyword">from</span> pygame.locals <span class="keyword">import</span> *

images_dir = os.path.join( <span class="string">".."</span>, <span class="string">"imagens-noalpha"</span> )

<span class="comment"># O random ser&#225; muito &#250;til para esse jogo, ele ajuda o jogo a perder
# a monotonia
</span><span class="keyword">import</span> random <span class="keyword">as</span> Random


<span class="keyword">class</span> <span class="type">GameObject</span>( pygame.sprite.Sprite ):
    <span class="string">"""
    Esta &#233; a classe b&#225;sica de todos os objetos do jogo.
    
    Na verdade as caixas de texto e o seu contador de vida n&#227;o s&#227;o desta
    classe, mas seria overkill utilizar uma classe pra fazer aquilo e neste
    caso, elas poderiam ser desta classe.

    Para n&#227;o precisar se preocupar com a renderiza&#231;&#227;o, vamos fazer a
    classe de forma que ela seja compat&#237;vel com o RenderPlain, que j&#225; possui
    uma fun&#231;&#227;o otimizada para renderiza&#231;&#227;o direta sobre a tela. Para isso,
    temos que ter tr&#234;s coisas nesta classe:
    
    1) Ser derivada de Sprite, isto &#233; uma boa coisa, pois a classe Sprite
       cria v&#225;rias facilidades para o nosso trabalho, como poder ser removida
       dos grupos em que foi colocada, inclusive o de Render, atrav&#233;s de
       uma chamada a self.kill()
       
    2) Ter self.image. Uma vez que precisamos carregar uma imagem, isto s&#243;
       nos define o nome que daremos a imagem a ser renderizada.
       
    3) Ter self.rect. Esse ret&#226;ngulo conter&#225; o tamanho da imagem e sua posi&#231;&#227;o.
       Nas formas:
           rect = ( ( x, y ), ( width, height ) )
       ou
           rect = ( x, y, width, height )
       e ainda nos fornece algumas facilidades em troca, como o rect.move que
       j&#225; desloca a imagem a ser renderizada com apenas um comando.
    """</span>
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, image, position, speed=<span class="py-pseudo-keyword">None</span> ):
        pygame.sprite.Sprite.__init__( <span class="py-pseudo-keyword">self</span> )
        <span class="py-pseudo-keyword">self</span>.image = image
        <span class="keyword">if</span> <span class="py-builtins">isinstance</span>( <span class="py-pseudo-keyword">self</span>.image, <span class="py-builtins">str</span> ):
            <span class="py-pseudo-keyword">self</span>.image = os.path.join( images_dir, <span class="py-pseudo-keyword">self</span>.image )
            <span class="py-pseudo-keyword">self</span>.image = pygame.image.load( <span class="py-pseudo-keyword">self</span>.image )

        <span class="py-pseudo-keyword">self</span>.rect  = <span class="py-pseudo-keyword">self</span>.image.get_rect()
        screen     = pygame.display.get_surface()
        <span class="py-pseudo-keyword">self</span>.area  = screen.get_rect()
        
        <span class="py-pseudo-keyword">self</span>.set_pos( position )
        <span class="py-pseudo-keyword">self</span>.set_speed( speed <span class="keyword">or</span> ( 0, 2 ) )
    <span class="comment"># __init__()
</span>

    
    <span class="keyword">def</span> <span class="function-name">update</span>( <span class="py-pseudo-keyword">self</span>, dt ):
        move_speed = ( <span class="py-pseudo-keyword">self</span>.speed[ 0 ] * dt / 16,
                       <span class="py-pseudo-keyword">self</span>.speed[ 1 ] * dt / 16 )
        <span class="py-pseudo-keyword">self</span>.rect  = <span class="py-pseudo-keyword">self</span>.rect.move( move_speed )
        <span class="keyword">if</span> ( <span class="py-pseudo-keyword">self</span>.rect.left &gt; <span class="py-pseudo-keyword">self</span>.area.right ) <span class="keyword">or</span> \
               ( <span class="py-pseudo-keyword">self</span>.rect.top &gt; <span class="py-pseudo-keyword">self</span>.area.bottom ) <span class="keyword">or</span> \
               ( <span class="py-pseudo-keyword">self</span>.rect.right &lt; 0 ):
            <span class="py-pseudo-keyword">self</span>.kill()
        <span class="keyword">if</span> ( <span class="py-pseudo-keyword">self</span>.rect.bottom &lt; - 40 ):
            <span class="py-pseudo-keyword">self</span>.kill()
    <span class="comment"># update()
</span>

    
    <span class="keyword">def</span> <span class="function-name">get_speed</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.speed
    <span class="comment"># get_speed()
</span>


    <span class="keyword">def</span> <span class="function-name">set_speed</span>( <span class="py-pseudo-keyword">self</span>, speed ):
        <span class="py-pseudo-keyword">self</span>.speed = speed
    <span class="comment"># set_speed()
</span>
    

    <span class="keyword">def</span> <span class="function-name">get_pos</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">return</span> ( <span class="py-pseudo-keyword">self</span>.rect.center[ 0 ],
                 <span class="py-pseudo-keyword">self</span>.rect.bottom )
    <span class="comment"># get_pos()
</span>    


    <span class="keyword">def</span> <span class="function-name">set_pos</span>( <span class="py-pseudo-keyword">self</span>, pos ):
        <span class="py-pseudo-keyword">self</span>.rect.center = ( pos[ 0 ], pos[ 1 ] )
    <span class="comment"># get_pos()
</span>


    <span class="keyword">def</span> <span class="function-name">get_size</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.image.get_size()
    <span class="comment"># get_size()
# GameObject
</span>



<span class="keyword">class</span> <span class="type">Fire</span>( GameObject ):
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, position, speed=<span class="py-pseudo-keyword">None</span>, image=<span class="py-pseudo-keyword">None</span>, list=<span class="py-pseudo-keyword">None</span> ):
        <span class="keyword">if</span> <span class="keyword">not</span> image:
            image = <span class="string">"tiro.png"</span>
        GameObject.__init__( <span class="py-pseudo-keyword">self</span>, image, position, speed )
        <span class="keyword">if</span> <span class="py-builtins">list</span> != <span class="py-pseudo-keyword">None</span>:
            <span class="py-pseudo-keyword">self</span>.add( <span class="py-builtins">list</span> )
    <span class="comment"># __init__()
# Fire
</span>


<span class="keyword">class</span> <span class="type">Ship</span>( GameObject ):
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, position, lives=0, speed=[ 0, 0 ], image=<span class="py-pseudo-keyword">None</span> ):
        <span class="py-pseudo-keyword">self</span>.acceleration = [ 3, 3 ]
        <span class="keyword">if</span> <span class="keyword">not</span> image:
            image = <span class="string">"nave.png"</span>
        GameObject.__init__( <span class="py-pseudo-keyword">self</span>, image, position, speed )
        <span class="py-pseudo-keyword">self</span>.set_lives( lives )
    <span class="comment"># __init__()
</span>
    

    <span class="keyword">def</span> <span class="function-name">get_lives</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.lives
    <span class="comment"># get_lives()
</span>


    <span class="keyword">def</span> <span class="function-name">set_lives</span>( <span class="py-pseudo-keyword">self</span>, lives ):
        <span class="py-pseudo-keyword">self</span>.lives = lives
    <span class="comment"># set_lives()
</span>


    <span class="keyword">def</span> <span class="function-name">fire</span>( <span class="py-pseudo-keyword">self</span>, fire_list, image=<span class="py-pseudo-keyword">None</span> ):
        s = <span class="py-builtins">list</span>( <span class="py-pseudo-keyword">self</span>.get_speed() )
        s[ 1 ] *= 2
        Fire( <span class="py-pseudo-keyword">self</span>.get_pos(), s, image, fire_list )
    <span class="comment"># fire()
</span>
    

    <span class="keyword">def</span> <span class="function-name">do_hit</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.get_lives() == 0:
            <span class="py-pseudo-keyword">self</span>.kill()
        <span class="keyword">else:</span>
            <span class="py-pseudo-keyword">self</span>.set_lives( <span class="py-pseudo-keyword">self</span>.get_lives() - 1 )
    <span class="comment"># do_hit()
</span>


    <span class="keyword">def</span> <span class="function-name">do_collision</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.get_lives() == 0:
            <span class="py-pseudo-keyword">self</span>.kill()
        <span class="keyword">else:</span>
            <span class="py-pseudo-keyword">self</span>.set_lives( <span class="py-pseudo-keyword">self</span>.get_lives() - 1 )
    <span class="comment"># do_collision()
</span>
    

    <span class="keyword">def</span> <span class="function-name">is_dead</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.get_lives() == 0
    <span class="comment"># is_dead()
</span>


    <span class="keyword">def</span> <span class="function-name">accel_top</span>( <span class="py-pseudo-keyword">self</span> ):
        speed = <span class="py-pseudo-keyword">self</span>.get_speed()
        <span class="py-pseudo-keyword">self</span>.set_speed( ( speed[ 0 ], speed[ 1 ] - <span class="py-pseudo-keyword">self</span>.acceleration[ 1 ] ) )
    <span class="comment"># accel_top
</span>


    <span class="keyword">def</span> <span class="function-name">accel_bottom</span>( <span class="py-pseudo-keyword">self</span> ):
        speed = <span class="py-pseudo-keyword">self</span>.get_speed()
        <span class="py-pseudo-keyword">self</span>.set_speed( ( speed[ 0 ], speed[ 1 ] + <span class="py-pseudo-keyword">self</span>.acceleration[ 1 ] ) )
    <span class="comment"># accel_bottom
</span>


    <span class="keyword">def</span> <span class="function-name">accel_left</span>( <span class="py-pseudo-keyword">self</span> ):        
        speed = <span class="py-pseudo-keyword">self</span>.get_speed()
        <span class="py-pseudo-keyword">self</span>.set_speed( ( speed[ 0 ] - <span class="py-pseudo-keyword">self</span>.acceleration[ 0 ], speed[ 1 ] ) )
    <span class="comment"># accel_left
</span>


    <span class="keyword">def</span> <span class="function-name">accel_right</span>( <span class="py-pseudo-keyword">self</span> ):
        speed = <span class="py-pseudo-keyword">self</span>.get_speed()
        <span class="py-pseudo-keyword">self</span>.set_speed( ( speed[ 0 ] + <span class="py-pseudo-keyword">self</span>.acceleration[ 0 ], speed[ 1 ] ) )
    <span class="comment"># accel_right
# Ship
</span>


<span class="keyword">class</span> <span class="type">Enemy</span>( Ship ):
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, position, lives=0, behaviour=0, image=<span class="py-pseudo-keyword">None</span> ):
        <span class="keyword">if</span> <span class="keyword">not</span> image:
            image = <span class="string">"inimigo.png"</span>

        <span class="keyword">if</span>   behaviour == 0: <span class="comment"># Inimigo normal, desce reto
</span>            speed = (  0, 3 )
        <span class="keyword">elif</span> behaviour == 1: <span class="comment"># Inimigo que desce da esquerda pra direita
</span>            speed = (  2, 3 )
        <span class="keyword">elif</span> behaviour == 2: <span class="comment"># Inimigo que desce da direita pra esquerda
</span>            speed = ( -2, 3 )
            
        Ship.__init__( <span class="py-pseudo-keyword">self</span>, position, lives, speed, image )
    <span class="comment"># __init__()
# Enemy
</span>



<span class="keyword">class</span> <span class="type">Player</span>( Ship ):
    <span class="string">"""
    A classe Player &#233; uma classe derivada da classe GameObject.
       No entanto, o personagem n&#227;o morre quando passa da borda, este s&#243;
    interrompe o seu movimento (vide update()).
       E possui experi&#234;ncia, que o far&#225; mudar de nivel e melhorar seu tiro.
       A fun&#231;&#227;o get_pos() s&#243; foi redefinida para que os tiros n&#227;o saissem da
    parte da frente da nave do personagem, por esta estar virada ao contr&#225;rio
    das outras.
       A fun&#231;&#227;o fire() foi redefinida para levar em conta a experi&#234;ncia do
    jogador (quanto mais experi&#234;ncia, mais tiros).
    """</span>
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, position, lives=10, image=<span class="py-pseudo-keyword">None</span> ):
        <span class="keyword">if</span> <span class="keyword">not</span> image:
            image = <span class="string">"nave.png"</span>
        Ship.__init__( <span class="py-pseudo-keyword">self</span>, position, lives, [ 0, 0 ], image )
        <span class="py-pseudo-keyword">self</span>.set_XP( 0 )
    <span class="comment"># __init__()
</span>

    
    <span class="keyword">def</span> <span class="function-name">update</span>( <span class="py-pseudo-keyword">self</span>, dt ):
        move_speed = ( <span class="py-pseudo-keyword">self</span>.speed[ 0 ] * dt / 16,
                       <span class="py-pseudo-keyword">self</span>.speed[ 1 ] * dt / 16)
        <span class="py-pseudo-keyword">self</span>.rect  = <span class="py-pseudo-keyword">self</span>.rect.move( move_speed )
        
        <span class="keyword">if</span> ( <span class="py-pseudo-keyword">self</span>.rect.right &gt; <span class="py-pseudo-keyword">self</span>.area.right ):
            <span class="py-pseudo-keyword">self</span>.rect.right = <span class="py-pseudo-keyword">self</span>.area.right
            
        <span class="keyword">elif</span> ( <span class="py-pseudo-keyword">self</span>.rect.left &lt; 0 ):
            <span class="py-pseudo-keyword">self</span>.rect.left = 0
            
        <span class="keyword">if</span> ( <span class="py-pseudo-keyword">self</span>.rect.bottom &gt; <span class="py-pseudo-keyword">self</span>.area.bottom ):
            <span class="py-pseudo-keyword">self</span>.rect.bottom = <span class="py-pseudo-keyword">self</span>.area.bottom
            
        <span class="keyword">elif</span> ( <span class="py-pseudo-keyword">self</span>.rect.top &lt; 0 ):
            <span class="py-pseudo-keyword">self</span>.rect.top = 0
    <span class="comment"># update()
</span>

    
    <span class="keyword">def</span> <span class="function-name">get_pos</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">return</span> ( <span class="py-pseudo-keyword">self</span>.rect.center[ 0 ], <span class="py-pseudo-keyword">self</span>.rect.top )
    <span class="comment"># get_pos()
</span>

    
    <span class="keyword">def</span> <span class="function-name">get_XP</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="keyword">return</span> <span class="py-pseudo-keyword">self</span>.XP
    <span class="comment"># get_XP()
</span>
    

    <span class="keyword">def</span> <span class="function-name">set_XP</span>( <span class="py-pseudo-keyword">self</span>, XP ):
        <span class="py-pseudo-keyword">self</span>.XP = XP
    <span class="comment"># get_XP()
</span>

    <span class="keyword">def</span> <span class="function-name">fire</span>( <span class="py-pseudo-keyword">self</span>, fire_list, image=<span class="py-pseudo-keyword">None</span> ):
        l = 1
        <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.XP &gt; 10: l = 3
        <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.XP &gt; 50: l = 5
        
        p      = <span class="py-pseudo-keyword">self</span>.get_pos()
        speeds = <span class="py-pseudo-keyword">self</span>.get_fire_speed( l )
        <span class="keyword">for</span> s <span class="keyword">in</span> speeds:
            Fire( p, s, image, fire_list )
    <span class="comment"># fire()
</span>


    <span class="keyword">def</span> <span class="function-name">get_fire_speed</span>( <span class="py-pseudo-keyword">self</span>, shots ):
        speeds = []

        <span class="keyword">if</span> shots &lt;= 0:
            <span class="keyword">return</span> speeds
        
        <span class="keyword">if</span> shots == 1:
            speeds += [ (  0, -5 ) ]
            
        <span class="keyword">if</span> shots &gt; 1 <span class="keyword">and</span> shots &lt;= 3:
            speeds += [ (  0, -5 ) ]
            speeds += [ ( -2, -3 ) ]
            speeds += [ (  2, -3 ) ]
            
        <span class="keyword">if</span> shots &gt; 3 <span class="keyword">and</span> shots &lt;= 5:
            speeds += [ (  0, -5 ) ]
            speeds += [ ( -2, -3 ) ]
            speeds += [ (  2, -3 ) ]
            speeds += [ ( -4, -2 ) ]
            speeds += [ (  4, -2 ) ]

        <span class="keyword">return</span> speeds
    <span class="comment"># get_fire_speed()
# Player
</span>


<span class="keyword">class</span> <span class="type">PlayerXPStatus</span>:
    <span class="string">"""
    Esta classe representa a experi&#234;ncia do usu&#225;rio
    """</span>
    font    = <span class="py-pseudo-keyword">None</span>
    last_xp = -1
    fgcolor = <span class="py-pseudo-keyword">None</span>
    bgcolor = <span class="py-pseudo-keyword">None</span>
    image   = <span class="py-pseudo-keyword">None</span>
    
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, player, pos=<span class="py-pseudo-keyword">None</span>, font=<span class="py-pseudo-keyword">None</span>, ptsize=30,
                  fgcolor=<span class="string">"0xffff00"</span>, bgcolor=<span class="py-pseudo-keyword">None</span> ):
        <span class="py-pseudo-keyword">self</span>.player  = player
        <span class="py-pseudo-keyword">self</span>.fgcolor = pygame.color.Color( fgcolor )
        <span class="keyword">if</span> bgcolor:
            <span class="py-pseudo-keyword">self</span>.bgcolor = pygame.color.Color( bgcolor )
        <span class="py-pseudo-keyword">self</span>.pos     = pos <span class="keyword">or</span> [ 0, 0 ]
        <span class="py-pseudo-keyword">self</span>.font    = pygame.font.Font( font, ptsize )
    <span class="comment"># __init__()
</span>
    <span class="keyword">def</span> <span class="function-name">update</span>( <span class="py-pseudo-keyword">self</span>, dt ):
        <span class="keyword">pass</span>
    <span class="comment"># update()
</span>
    <span class="keyword">def</span> <span class="function-name">draw</span>( <span class="py-pseudo-keyword">self</span>, screen ):
        xp = <span class="py-pseudo-keyword">self</span>.player.get_XP()
        <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.last_xp != xp:
            <span class="py-pseudo-keyword">self</span>.last_xp = xp
            text = <span class="string">"XP: % 4d"</span> % xp
            <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.bgcolor:
                <span class="py-pseudo-keyword">self</span>.image = <span class="py-pseudo-keyword">self</span>.font.render( text, <span class="py-pseudo-keyword">False</span>, <span class="py-pseudo-keyword">self</span>.fgcolor,
                                               <span class="py-pseudo-keyword">self</span>.bgcolor )
            <span class="keyword">else:</span>
                <span class="py-pseudo-keyword">self</span>.image = <span class="py-pseudo-keyword">self</span>.font.render( text, <span class="py-pseudo-keyword">False</span>, <span class="py-pseudo-keyword">self</span>.fgcolor,
                                               ( 255, 0, 255 ) )
                <span class="py-pseudo-keyword">self</span>.image.set_colorkey( ( 255, 0, 255 ), RLEACCEL )
                
        screen.blit( <span class="py-pseudo-keyword">self</span>.image, <span class="py-pseudo-keyword">self</span>.pos )
            
    <span class="comment"># draw()
# PlayerXPStatus
</span>



<span class="keyword">class</span> <span class="type">PlayerLifeStatus</span>:
    <span class="string">"""
    Esta classe representa o contador de vidas do jogador
    """</span>
    player     = <span class="py-pseudo-keyword">None</span>
    pos        = <span class="py-pseudo-keyword">None</span>
    image      = <span class="py-pseudo-keyword">None</span>
    size_image = <span class="py-pseudo-keyword">None</span>
    spacing    = 5
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, player, pos=<span class="py-pseudo-keyword">None</span>, image=<span class="py-pseudo-keyword">None</span> ):
        <span class="py-pseudo-keyword">self</span>.image = image <span class="keyword">or</span> <span class="string">"nave_status.png"</span>
        <span class="keyword">if</span> <span class="py-builtins">isinstance</span>( <span class="py-pseudo-keyword">self</span>.image, <span class="py-builtins">str</span> ):
            <span class="py-pseudo-keyword">self</span>.image = os.path.join( images_dir, <span class="py-pseudo-keyword">self</span>.image )
            <span class="py-pseudo-keyword">self</span>.image = pygame.image.load( <span class="py-pseudo-keyword">self</span>.image )
            
        <span class="py-pseudo-keyword">self</span>.player     = player
        <span class="py-pseudo-keyword">self</span>.pos        = pos <span class="keyword">or</span> [ 5, 5 ]
        <span class="py-pseudo-keyword">self</span>.size_image = <span class="py-pseudo-keyword">self</span>.image.get_size()
    <span class="comment"># __init__()
</span>


    <span class="keyword">def</span> <span class="function-name">update</span>( <span class="py-pseudo-keyword">self</span>, dt ):
        <span class="keyword">pass</span>
    <span class="comment"># update()
</span>


    <span class="keyword">def</span> <span class="function-name">draw</span>( <span class="py-pseudo-keyword">self</span>, screen ):
        pos = copy.copy( <span class="py-pseudo-keyword">self</span>.pos )
        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="py-builtins">range</span>( <span class="py-pseudo-keyword">self</span>.player.get_lives() ):
            pos[ 0 ] += <span class="py-pseudo-keyword">self</span>.size_image[ 0 ] + <span class="py-pseudo-keyword">self</span>.spacing
            screen.blit( <span class="py-pseudo-keyword">self</span>.image, pos )
    <span class="comment"># draw()
# PlayerLifeStatus
</span>



<span class="keyword">class</span> <span class="type">Background</span>:
    <span class="string">"""
    Esta classe representa o ator "</span>Fundo<span class="string">" do jogo.

    Ela poreria ser herdeira de GameObject, por&#233;m como ela n&#227;o precisa de todos
    aqueles recursos, implemento somente alguns m&#233;todos (update() e draw())
    """</span>
    image = <span class="py-pseudo-keyword">None</span>
    pos   = <span class="py-pseudo-keyword">None</span>
    
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, image=<span class="string">"tile.png"</span> ):
        <span class="string">"""
        Com essa fun&#231;&#227;o criamos uma superf&#237;cie, formada de uma repeti&#231;&#227;o da
        imagem passada, de forma a cobrir a tela e um pouco mais.

        Aqui &#233; o &#250;nico lugar onde podemos carregar a imagem, utilizando
            load( image ).convert(),
        este comando n&#227;o tem nenhuma rela&#231;&#227;o com o formato de arquivo da
        imagem. Ele converte a imagem para o formato do pixel[1] da tela,
        representando um ganho de at&#233; 6X na performance final[2].

        [1] Formato de Pixel: Toda imagem &#233; formada por um conjunto de pixels,
            estes s&#227;o descritos por uma quantidade de bits que representam as
            cores. Em geral utiliza-se RGB (Red, Green, Blue) ou RGBA (RGB +
            Aplha/Transpar&#234;ncia).    Em geral a tela tem um formato de 16 BPP
            (bits per pixel) e as imagens com transpar&#234;ncia s&#227;o 32 BPP (RGBA,
            varia&#231;&#227;o de 256 n&#237;veis para cada cor e transpar&#234;ncia). Ao converter
            para o formato da tela, voc&#234; perde a resolu&#231;&#227;o de cores e a
            transpar&#234;ncia, como estas n&#227;o s&#227;o informa&#231;&#245;es importantes para o
            fundo, &#233; conveniente converter para este formato.
        [2] O ganho de performance se d&#225; &#224; necessidade de mesclar as imagens
            (usando o canal alpha) e ent&#227;o transformar para o formato da tela.
            Ao converter, elimina-se o alpha (e a necessidade de mesclar) e a
            necessidade de converter a cada "</span>blit<span class="string">".
        """</span>

        <span class="keyword">if</span> <span class="py-builtins">isinstance</span>( image, <span class="py-builtins">str</span> ):
            image = os.path.join( images_dir, image )
            image = pygame.image.load( image )
            image.set_alpha( <span class="py-pseudo-keyword">None</span>, RLEACCEL ) <span class="comment"># disable alpha
</span>            image = image.convert()

        <span class="py-pseudo-keyword">self</span>.isize = image.get_size()
        <span class="py-pseudo-keyword">self</span>.pos = [ 0, -1 * <span class="py-pseudo-keyword">self</span>.isize[ 1 ] ]
        screen      = pygame.display.get_surface()
        screen_size = screen.get_size()

        <span class="keyword">from</span> math <span class="keyword">import</span> ceil
        w = ( ceil( <span class="py-builtins">float</span>( screen_size[ 0 ] ) / <span class="py-pseudo-keyword">self</span>.isize[ 0 ] ) + 1 ) * \
            <span class="py-pseudo-keyword">self</span>.isize[ 0 ]
        h = ( ceil( <span class="py-builtins">float</span>( screen_size[ 1 ] ) / <span class="py-pseudo-keyword">self</span>.isize[ 1 ] ) + 1 ) * \
            <span class="py-pseudo-keyword">self</span>.isize[ 1 ]

        back = pygame.Surface( ( w, h ) )
        
        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="py-builtins">range</span>( ( back.get_size()[ 0 ] / <span class="py-pseudo-keyword">self</span>.isize[ 0 ] ) ):
            <span class="keyword">for</span> j <span class="keyword">in</span> <span class="py-builtins">range</span>( ( back.get_size()[ 1 ] / <span class="py-pseudo-keyword">self</span>.isize[ 1 ] ) ):
                back.blit( image, ( i * <span class="py-pseudo-keyword">self</span>.isize[ 0 ], j * <span class="py-pseudo-keyword">self</span>.isize[ 1 ] ) )

        back.set_alpha( <span class="py-pseudo-keyword">None</span>, RLEACCEL )
        <span class="py-pseudo-keyword">self</span>.image = back.convert()
    <span class="comment"># __init__()
</span>


    <span class="keyword">def</span> <span class="function-name">update</span>( <span class="py-pseudo-keyword">self</span>, dt ):
        <span class="py-pseudo-keyword">self</span>.pos[ 1 ] += 1
        <span class="keyword">if</span> ( <span class="py-pseudo-keyword">self</span>.pos[ 1 ] &gt; 0 ):
            <span class="py-pseudo-keyword">self</span>.pos[ 1 ] -= <span class="py-pseudo-keyword">self</span>.isize[ 1 ]
    <span class="comment"># update()
</span>


    <span class="keyword">def</span> <span class="function-name">draw</span>( <span class="py-pseudo-keyword">self</span>, screen ):
        screen.blit( <span class="py-pseudo-keyword">self</span>.image, <span class="py-pseudo-keyword">self</span>.pos )
    <span class="comment"># draw()
# Background
</span>



<span class="keyword">class</span> <span class="type">Game</span>:
    screen      = <span class="py-pseudo-keyword">None</span>
    screen_size = <span class="py-pseudo-keyword">None</span>
    run         = <span class="py-pseudo-keyword">True</span>
    interval    = 0
    level       = 0
    <span class="py-builtins">list</span>        = <span class="py-pseudo-keyword">None</span>
    player      = <span class="py-pseudo-keyword">None</span>
    player_life = <span class="py-pseudo-keyword">None</span>
    player_xp   = <span class="py-pseudo-keyword">None</span>
    background  = <span class="py-pseudo-keyword">None</span>    
    
    <span class="keyword">def</span> <span class="function-name">__init__</span>( <span class="py-pseudo-keyword">self</span>, size, fullscreen ):
        <span class="string">"""
        Esta &#233; a fun&#231;&#227;o que inicializa o pygame, define a resolu&#231;&#227;o da tela,
        caption, e disabilitamos o mouse dentro desta.
        """</span>
        actors = {}
        pygame.init()
        flags = DOUBLEBUF
        <span class="keyword">if</span> fullscreen:
            flags |= FULLSCREEN
        <span class="py-pseudo-keyword">self</span>.screen       = pygame.display.set_mode( size, flags )
        <span class="py-pseudo-keyword">self</span>.screen_size = <span class="py-pseudo-keyword">self</span>.screen.get_size()

        pygame.mouse.set_visible( 0 )
        pygame.display.set_caption( <span class="string">'T&#237;tulo da Janela'</span> )

        <span class="py-pseudo-keyword">self</span>.load_images()
    <span class="comment"># init()
</span>


    <span class="keyword">def</span> <span class="function-name">load_images</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="string">"""
        L&#234; as imagens necessarias pelo jogo.
        """</span>
        <span class="keyword">def</span> <span class="function-name">load_image</span>( filename ):
            img = pygame.image.load( os.path.join( images_dir, filename ) )
            img.set_alpha( <span class="py-pseudo-keyword">None</span>, RLEACCEL ) <span class="comment"># disable alpha.
</span>            img.convert()
            img.set_colorkey( ( 255, 0, 255 ), RLEACCEL ) <span class="comment"># magenta
</span>            <span class="keyword">return</span> img
        <span class="comment"># load_image()
</span>
        <span class="py-pseudo-keyword">self</span>.image_player        = load_image( <span class="string">"nave.png"</span> )
        <span class="py-pseudo-keyword">self</span>.image_player_status = load_image( <span class="string">"nave_status.png"</span> )
        <span class="py-pseudo-keyword">self</span>.image_enemy         = load_image( <span class="string">"inimigo.png"</span> )
        <span class="py-pseudo-keyword">self</span>.image_fire          = load_image( <span class="string">"tiro.png"</span> )
        <span class="py-pseudo-keyword">self</span>.image_enemy_fire    = load_image( <span class="string">"tiro_inimigo.png"</span> )
    <span class="comment"># load_images()
</span>

    
    <span class="keyword">def</span> <span class="function-name">handle_events</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="string">"""
        Trata o evento e toma a a&#231;&#227;o necess&#225;ria.
        """</span>
        player = <span class="py-pseudo-keyword">self</span>.player

        <span class="keyword">for</span> event <span class="keyword">in</span> pygame.event.get():
            t = event.type
            <span class="keyword">if</span> t <span class="keyword">in</span> ( KEYDOWN, KEYUP ):
                k = event.key
        
            <span class="keyword">if</span> t == QUIT:
                <span class="py-pseudo-keyword">self</span>.run = <span class="py-pseudo-keyword">False</span>

            <span class="keyword">elif</span> t == KEYDOWN:
                <span class="keyword">if</span>   k == K_ESCAPE:
                    <span class="py-pseudo-keyword">self</span>.run = <span class="py-pseudo-keyword">False</span>
                <span class="keyword">elif</span> k == K_LCTRL <span class="keyword">or</span> k == K_RCTRL:
                    <span class="py-pseudo-keyword">self</span>.interval = 0
                    player.fire( <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"fire"</span> ], <span class="py-pseudo-keyword">self</span>.image_fire )
                <span class="keyword">elif</span> k == K_UP:
                    player.accel_top()
                <span class="keyword">elif</span> k == K_DOWN:
                    player.accel_bottom()
                <span class="keyword">elif</span> k == K_RIGHT:
                    player.accel_right()
                <span class="keyword">elif</span> k == K_LEFT:
                    player.accel_left()
        
            <span class="keyword">elif</span> t == KEYUP:
                <span class="keyword">if</span>   k == K_DOWN:
                    player.accel_top()
                <span class="keyword">elif</span> k == K_UP:
                    player.accel_bottom()
                <span class="keyword">elif</span> k == K_LEFT:
                    player.accel_right()
                <span class="keyword">elif</span> k == K_RIGHT:
                    player.accel_left()
        
            keys = pygame.key.get_pressed()
            <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.interval &gt; 10:
                <span class="py-pseudo-keyword">self</span>.interval = 0
                <span class="keyword">if</span> keys[ K_RCTRL ] <span class="keyword">or</span> keys[ K_LCTRL ]:
                    player.fire( <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"fire"</span> ], <span class="py-pseudo-keyword">self</span>.image_fire )
    <span class="comment"># handle_events()
</span>



    <span class="keyword">def</span> <span class="function-name">actors_update</span>( <span class="py-pseudo-keyword">self</span>, dt ):        
        <span class="py-pseudo-keyword">self</span>.background.update( dt )
        
        <span class="keyword">for</span> actor <span class="keyword">in</span> <span class="py-pseudo-keyword">self</span>.list.values():
            actor.update( dt )
            
        <span class="py-pseudo-keyword">self</span>.player_life.update( dt )
        <span class="py-pseudo-keyword">self</span>.player_xp.update( dt )
    <span class="comment"># actors_update()
</span>


    <span class="keyword">def</span> <span class="function-name">actors_draw</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="py-pseudo-keyword">self</span>.background.draw( <span class="py-pseudo-keyword">self</span>.screen )
        
        <span class="keyword">for</span> actor <span class="keyword">in</span> <span class="py-pseudo-keyword">self</span>.list.values():
            actor.draw( <span class="py-pseudo-keyword">self</span>.screen )
            
        <span class="py-pseudo-keyword">self</span>.player_life.draw( <span class="py-pseudo-keyword">self</span>.screen )
        <span class="py-pseudo-keyword">self</span>.player_xp.draw( <span class="py-pseudo-keyword">self</span>.screen )
    <span class="comment"># actors_draw()
</span>    


    <span class="keyword">def</span> <span class="function-name">actor_check_hit</span>( <span class="py-pseudo-keyword">self</span>, actor, list, action ):
        <span class="keyword">if</span>   <span class="py-builtins">isinstance</span>( actor, pygame.sprite.RenderPlain ):
            hitted = pygame.sprite.groupcollide( actor, list, 1, 0 )
            <span class="keyword">for</span> v <span class="keyword">in</span> hitted.values():
                <span class="keyword">for</span> o <span class="keyword">in</span> v:
                    action( o )
            <span class="keyword">return</span> hitted
        
        <span class="keyword">elif</span> <span class="py-builtins">isinstance</span>( actor, pygame.sprite.Sprite ):
            <span class="keyword">if</span> pygame.sprite.spritecollide( actor, list, 1 ):
                action()
            <span class="keyword">return</span> actor.is_dead()
    <span class="comment"># actor_check_hit()
</span>

    
    <span class="keyword">def</span> <span class="function-name">actors_act</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="comment"># Verifica se personagem foi atingido por um tiro
</span>        <span class="py-pseudo-keyword">self</span>.actor_check_hit( <span class="py-pseudo-keyword">self</span>.player, <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"enemies_fire"</span> ],
                              <span class="py-pseudo-keyword">self</span>.player.do_hit )
        <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.player.is_dead():
            <span class="py-pseudo-keyword">self</span>.run = <span class="py-pseudo-keyword">False</span>
            <span class="keyword">return</span>
            
        <span class="comment"># Verifica se o personagem trombou em algum inimigo
</span>        <span class="py-pseudo-keyword">self</span>.actor_check_hit( <span class="py-pseudo-keyword">self</span>.player, <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"enemies"</span> ],
                              <span class="py-pseudo-keyword">self</span>.player.do_collision )
        <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.player.is_dead():
            <span class="py-pseudo-keyword">self</span>.run = <span class="py-pseudo-keyword">False</span>
            <span class="keyword">return</span>

        <span class="comment"># Verifica se o personagem atingiu algum alvo.
</span>        hitted = <span class="py-pseudo-keyword">self</span>.actor_check_hit( <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"fire"</span> ],
                                       <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"enemies"</span> ],
                                       Enemy.do_hit )
        
        <span class="comment"># Aumenta a eXPeri&#234;ncia baseado no n&#250;mero de acertos:
</span>        <span class="py-pseudo-keyword">self</span>.player.set_XP( <span class="py-pseudo-keyword">self</span>.player.get_XP() + <span class="py-builtins">len</span>( hitted ) )
    <span class="comment"># actors_check_hit()
</span>


    <span class="keyword">def</span> <span class="function-name">change_level</span>( <span class="py-pseudo-keyword">self</span> ):
        xp = <span class="py-pseudo-keyword">self</span>.player.get_XP()
        <span class="keyword">if</span>   xp &gt; 10  <span class="keyword">and</span> <span class="py-pseudo-keyword">self</span>.level == 0:
            <span class="py-pseudo-keyword">self</span>.background = Background( <span class="string">"tile2.png"</span> )
            <span class="py-pseudo-keyword">self</span>.level = 1
            <span class="py-pseudo-keyword">self</span>.player.set_lives( <span class="py-pseudo-keyword">self</span>.player.get_lives() + 3 )
        <span class="keyword">elif</span> xp &gt; 50  <span class="keyword">and</span> <span class="py-pseudo-keyword">self</span>.level == 1:
            <span class="py-pseudo-keyword">self</span>.background = Background( <span class="string">"tile3.png"</span> )
            <span class="py-pseudo-keyword">self</span>.level = 2        
            <span class="py-pseudo-keyword">self</span>.player.set_lives( <span class="py-pseudo-keyword">self</span>.player.get_lives() + 6 )
    <span class="comment"># change_level()
</span>


    <span class="keyword">def</span> <span class="function-name">manage</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="py-pseudo-keyword">self</span>.ticks += 1
        <span class="comment"># Faz os inimigos atirarem aleat&#243;riamente
</span>        <span class="keyword">if</span> <span class="py-pseudo-keyword">self</span>.ticks &gt; Random.randint( 20, 30 ):
            <span class="keyword">for</span> enemy <span class="keyword">in</span> <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"enemies"</span> ].sprites():
                <span class="keyword">if</span> Random.randint( 0, 10 ) &gt; 5:
                    enemy.fire( <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"enemies_fire"</span> ],
                                image=<span class="py-pseudo-keyword">self</span>.image_enemy_fire )
                    <span class="py-pseudo-keyword">self</span>.ticks = 0
        
        <span class="comment"># criamos mais inimigos randomicamente para o jogo n&#227;o ficar chato
</span>        r = Random.randint( 0, 100 )
        x = Random.randint( 1, <span class="py-pseudo-keyword">self</span>.screen_size[ 0 ] / 20 )
        <span class="keyword">if</span> ( r &gt; ( 40 * <span class="py-builtins">len</span>( <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"enemies"</span> ] ) ) ):
            behaviour = Random.randint( 0, 2 )
            lives     = <span class="py-pseudo-keyword">self</span>.level
            enemy     = Enemy( [ 0, 0 ], lives, behaviour,
                               image=<span class="py-pseudo-keyword">self</span>.image_enemy )
            size      = enemy.get_size()
            enemy.set_pos( [ x * size[ 0 ], - size[ 1 ] ] )
            <span class="py-pseudo-keyword">self</span>.list[ <span class="string">"enemies"</span> ].add( enemy )


        <span class="comment"># Verifica se ascendeu de n&#237;vel
</span>        <span class="py-pseudo-keyword">self</span>.change_level()
    <span class="comment"># manage()
</span>

    
    <span class="keyword">def</span> <span class="function-name">loop</span>( <span class="py-pseudo-keyword">self</span> ):
        <span class="string">"""
        La&#231;o principal
        """</span>
        <span class="comment"># Criamos o fundo
</span>        <span class="py-pseudo-keyword">self</span>.background = Background( <span class="string">"tile.png"</span> )

        <span class="comment"># Inicializamos o relogio e o dt que vai limitar o valor de
</span>        <span class="comment"># frames por segundo do jogo
</span>        clock         = pygame.time.Clock()
        dt            = 16
        <span class="py-pseudo-keyword">self</span>.ticks    = 0
        <span class="py-pseudo-keyword">self</span>.interval = 1

        pos         = [ <span class="py-pseudo-keyword">self</span>.screen_size[ 0 ] / 2, <span class="py-pseudo-keyword">self</span>.screen_size[ 1 ] ]
        <span class="py-pseudo-keyword">self</span>.player = Player( pos, lives=10, image=<span class="py-pseudo-keyword">self</span>.image_player )

        <span class="py-pseudo-keyword">self</span>.player_life = PlayerLifeStatus( <span class="py-pseudo-keyword">self</span>.player, [ 5, 5 ],
                                             image=<span class="py-pseudo-keyword">self</span>.image_player_status )
        <span class="py-pseudo-keyword">self</span>.player_xp   = PlayerXPStatus( <span class="py-pseudo-keyword">self</span>.player,
                                           [ <span class="py-pseudo-keyword">self</span>.screen_size[ 0 ] - 100, 5 ],
                                           fgcolor=<span class="string">"0xff0000"</span> )

        <span class="py-pseudo-keyword">self</span>.list = {
            <span class="string">"player"</span>       : pygame.sprite.RenderPlain( <span class="py-pseudo-keyword">self</span>.player ),
            <span class="string">"enemies"</span>      : pygame.sprite.RenderPlain( Enemy( [ 120, 0 ],
                                                               image=<span class="py-pseudo-keyword">self</span>.image_enemy ) ),
            <span class="string">"fire"</span>         : pygame.sprite.RenderPlain(),
            <span class="string">"enemies_fire"</span> : pygame.sprite.RenderPlain()
            }

        <span class="comment"># assim iniciamos o loop principal do programa
</span>        <span class="keyword">while</span> <span class="py-pseudo-keyword">self</span>.run:
            clock.tick( 1000 / dt )
            <span class="py-pseudo-keyword">self</span>.interval += 1

            <span class="comment"># Handle Input Events
</span>            <span class="py-pseudo-keyword">self</span>.handle_events()

            <span class="comment"># Atualiza Elementos
</span>            <span class="py-pseudo-keyword">self</span>.actors_update( dt )

            <span class="comment"># Fa&#231;a os atores atuarem
</span>            <span class="py-pseudo-keyword">self</span>.actors_act()

            <span class="comment"># Fa&#231;a a manuten&#231;&#227;o do jogo, como criar inimigos, etc.
</span>            <span class="py-pseudo-keyword">self</span>.manage()
            
            <span class="comment"># Desenhe para o back buffer
</span>            <span class="py-pseudo-keyword">self</span>.actors_draw()
            
            <span class="comment"># ao fim do desenho temos que trocar o front buffer e o back buffer
</span>            pygame.display.flip()

            <span class="keyword">print</span> <span class="string">"FPS: %0.2f"</span> % clock.get_fps()
        <span class="comment"># while self.run
</span>    <span class="comment"># loop()
# Game
</span>

<span class="keyword">def</span> <span class="function-name">usage</span>():
    <span class="string">"""
    Imprime informa&#231;&#245;es de uso deste programa.
    """</span>
    prog = sys.argv[ 0 ]
    <span class="keyword">print</span> <span class="string">"Usage:"</span>
    <span class="keyword">print</span> <span class="string">"\t%s [-f|--fullscreen] [-r &lt;XxY&gt;|--resolution=&lt;XxY&gt;]"</span> % prog
    <span class="keyword">print</span>
<span class="comment"># usage()
</span>


<span class="keyword">def</span> <span class="function-name">parse_opts</span>( argv ):
    <span class="string">"""
    Pega as informa&#231;&#245;es da linha de comando e retorna 
    """</span>
    <span class="comment"># Analise a linha de commando usando 'getopt'
</span>    <span class="keyword">try:</span>
        opts, args = getopt.gnu_getopt( argv[ 1 : ],
                                        <span class="string">"hfr:"</span>,
                                        [ <span class="string">"help"</span>,
                                          <span class="string">"fullscreen"</span>,
                                          <span class="string">"resolution="</span> ] )
    <span class="keyword">except</span> getopt.GetoptError:
        <span class="comment"># imprime informacao e sai
</span>        usage()
        sys.exit( 2 )

    options = {
        <span class="string">"fullscreen"</span>:  <span class="py-pseudo-keyword">False</span>,
        <span class="string">"resolution"</span>: ( 640, 480 ),
        }

    <span class="keyword">for</span> o, a <span class="keyword">in</span> opts:
        <span class="keyword">if</span> o <span class="keyword">in</span> ( <span class="string">"-f"</span>, <span class="string">"--fullscreen"</span> ):
            options[ <span class="string">"fullscreen"</span> ] = <span class="py-pseudo-keyword">True</span>
        <span class="keyword">elif</span> o <span class="keyword">in</span> ( <span class="string">"-h"</span>, <span class="string">"--help"</span> ):
            usage()
            sys.exit( 0 )
        <span class="keyword">elif</span> o <span class="keyword">in</span> ( <span class="string">"-r"</span>, <span class="string">"--resolution"</span> ):
            a = a.lower()
            r = a.split( <span class="string">"x"</span> )
            <span class="keyword">if</span> <span class="py-builtins">len</span>( r ) == 2:
                options[ <span class="string">"resolution"</span> ] = r
                <span class="keyword">continue</span>

            r = a.split( <span class="string">","</span> )
            <span class="keyword">if</span> <span class="py-builtins">len</span>( r ) == 2:
                options[ <span class="string">"resolution"</span> ] = r
                <span class="keyword">continue</span>

            r = a.split( <span class="string">":"</span> )
            <span class="keyword">if</span> <span class="py-builtins">len</span>( r ) == 2:
                options[ <span class="string">"resolution"</span> ] = r
                <span class="keyword">continue</span>
    <span class="comment"># for o, a in opts
</span>    r = options[ <span class="string">"resolution"</span> ]
    options[ <span class="string">"resolution"</span> ] = [ <span class="py-builtins">int</span>( r[ 0 ] ), <span class="py-builtins">int</span>( r[ 1 ] ) ]
    <span class="keyword">return</span> options
<span class="comment"># parse_opts()
</span>


<span class="keyword">def</span> <span class="function-name">main</span>( argv ):
    <span class="comment">#primeiro vamos verificar que estamos no diretorio certo para conseguir
</span>    <span class="comment">#encontrar as imagens e outros recursos, e inicializar o pygame com as
</span>    <span class="comment">#opcoes passadas pela linha de comando
</span>    fullpath = os.path.abspath( argv[ 0 ] )
    <span class="py-builtins">dir</span> = os.path.dirname( fullpath )
    os.chdir( <span class="py-builtins">dir</span> )

    options = parse_opts( argv )
    game = Game( options[ <span class="string">"resolution"</span> ], options[ <span class="string">"fullscreen"</span> ] )
    game.loop()
<span class="comment"># main()
</span>        
<span class="comment"># este comando fala para o python chamar o main se estao executando o script
</span><span class="keyword">if</span> <span class="py-builtins">__name__</span> == <span class="string">'__main__'</span>:
    main( sys.argv )
</pre>
  </body>
</html>
